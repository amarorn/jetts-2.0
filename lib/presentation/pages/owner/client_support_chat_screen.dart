import 'package:flutter/material.dart';
import '../../../design_system/tokens/app_colors.dart';
import '../../../design_system/tokens/app_typography.dart';

class ClientSupportChatScreen extends StatefulWidget {
  const ClientSupportChatScreen({super.key});

  @override
  State<ClientSupportChatScreen> createState() =>
      _ClientSupportChatScreenState();
}

class _ClientSupportChatScreenState extends State<ClientSupportChatScreen> {
  final TextEditingController _controller = TextEditingController();
  final List<_ChatMessage> _messages = [];

  final Map<String, String> chatbotKnowledgeBase = {
    // ================ SAUDA√á√ïES E CORTESIA ================
    'ol√°': 'Ol√°! Bem-vindo ao Jetts! üö¢ Como posso ajudar voc√™ hoje?',
    'oi': 'Oi! Como posso ajudar voc√™ hoje?',
    'boa tarde': 'Boa tarde! Como posso ajudar voc√™ no Jetts hoje?',
    'bom dia': 'Bom dia! Pronto para navegar? Como posso ajudar?',
    'boa noite': 'Boa noite! Como posso ajudar voc√™ no Jetts?',
    'obrigado': 'De nada! Se precisar de mais alguma coisa, √© s√≥ perguntar. üòä',
    'valeu': 'Sempre √†s ordens! Precisa de mais alguma coisa?',
    'tchau': 'At√© logo! Tenha √≥timas navega√ß√µes! ‚õµ',
    'adeus': 'At√© mais! Estarei aqui quando precisar! üåä',

    // ================ CADASTRO E LOGIN ================
    'como criar conta': 'Para criar sua conta: 1) Clique em "Cadastrar" na tela inicial, 2) Preencha nome, email e senha, 3) Aceite os termos de uso, 4) Clique em "Criar Conta". Voc√™ tamb√©m pode entrar com Google ou Apple.',
    'como fazer login': 'Na tela inicial, digite seu email e senha, ou use login social (Google/Apple). Marque "Lembrar de mim" para facilitar pr√≥ximos acessos.',
    'esqueci minha senha': 'Na tela de login, clique em "Esqueci minha senha", digite seu email e siga as instru√ß√µes que enviaremos.',
    'como alterar senha': 'V√° em "Perfil" > "Configura√ß√µes" > "Alterar Senha" e digite sua senha atual e a nova.',
    'como sair do app': 'Acesse o menu "Perfil" e clique em "Sair" para deslogar da sua conta.',
    'n√£o consigo entrar': 'Verifique se email e senha est√£o corretos. Se persistir, use "Esqueci minha senha" ou entre em contato conosco.',

    // ================ BUSCA E FILTROS ================
    'como buscar barco': 'Use a barra de busca na tela inicial para pesquisar por nome, localiza√ß√£o ou tipo de barco. Voc√™ tamb√©m pode usar busca por voz clicando no microfone.',
    'como usar filtros': 'Na tela de busca, ajuste: pre√ßo (R$ 500-5000), capacidade de pessoas, avalia√ß√£o m√≠nima, categorias (Luxo, Esporte, Fam√≠lia) e comodidades desejadas.',
    'busca por voz': 'Clique no √≠cone do microfone na barra de busca e fale o que procura. Ex: "barco de luxo no Rio de Janeiro".',
    'como filtrar por pre√ßo': 'Na busca, use o slider de pre√ßo para definir o range entre R$ 500 e R$ 5.000 por dia.',
    'como ver barcos pr√≥ximos': 'O app usa sua localiza√ß√£o para mostrar barcos pr√≥ximos. Certifique-se que a localiza√ß√£o est√° ativada.',
    'categorias de barco': 'Temos: Luxo (iates premium), Esporte (lanchas r√°pidas), Fam√≠lia (embarca√ß√µes espa√ßosas), Rom√¢ntico (ambiente √≠ntimo), Econ√¥mico (op√ß√µes em conta).',

    // ================ RESERVAS ================
    'como fazer reserva': 'Escolha o barco, selecione datas no calend√°rio, n√∫mero de pessoas, adicione observa√ß√µes e clique em "Reservar". Depois escolha forma de pagamento.',
    'como cancelar reserva': 'Acesse "Minhas Reservas", selecione a reserva e clique em "Cancelar". Veja a pol√≠tica de cancelamento antes.',
    'como ver minhas reservas': 'Na tela inicial, clique em "Minhas Reservas" ou acesse pelo menu principal.',
    'posso alterar data': 'Sim! Em "Minhas Reservas", clique na reserva e em "Alterar Data" (sujeito √† disponibilidade e taxas).',
    'como ver hist√≥rico': 'Clique no √≠cone de "Hist√≥rico" na tela inicial ou v√° em "Perfil" > "Hist√≥rico de Reservas".',
    'reserva est√° confirmada': 'Verifique em "Minhas Reservas". Reservas confirmadas aparecem em verde com status "Confirmada".',
    'n√£o recebi confirma√ß√£o': 'Verifique sua caixa de entrada e spam. Se n√£o chegou, v√° em "Minhas Reservas" para ver o status.',
    'posso levar animais': 'Depende do barco. Verifique na descri√ß√£o se aceita pets ou pergunte ao propriet√°rio no chat.',

    // ================ PAGAMENTOS ================
    'formas de pagamento': 'Aceitamos: Cart√£o de Cr√©dito, Cart√£o de D√©bito e PIX. Pagamento √© seguro e processado na hora.',
    'quais cart√µes aceitam': 'Aceitamos Visa, Mastercard, Elo, American Express e outros cart√µes nacionais e internacionais.',
    'como pagar com pix': 'Escolha PIX no pagamento, escaneie o QR Code ou copie a chave PIX. Pagamento √© confirmado automaticamente.',
    'posso parcelar': 'Sim! Cart√µes de cr√©dito podem ser parcelados em at√© 12x (consulte taxas do seu cart√£o).',
    'como dividir pagamento': 'Na tela de pagamento, clique em "Dividir Conta", adicione email dos amigos e defina valores. Cada um paga sua parte.',
    'taxa de servi√ßo': 'Inclu√≠mos uma pequena taxa de servi√ßo para manter a plataforma. O valor total j√° aparece antes do pagamento.',
    'posso usar cupom': 'Sim! Digite o c√≥digo do cupom na tela de pagamento antes de finalizar.',
    'onde vejo cupons': 'Clique em "Promo√ß√µes" na tela inicial para ver ofertas e cupons dispon√≠veis.',

    // ================ BARCOS E DETALHES ================
    'tipos de barco': 'Temos: Iates de Luxo, Lanchas Esportivas, Veleiros, Catamar√£s, Jet Skis, Barcos de Pesca e embarca√ß√µes para eventos.',
    'o que inclui aluguel': 'Inclui: acesso ao barco, equipamentos b√°sicos de seguran√ßa, combust√≠vel b√°sico. Pode incluir tripula√ß√£o (varia por barco).',
    'precisa de habilita√ß√£o': 'Alguns barcos exigem habilita√ß√£o n√°utica. Verificamos isso na reserva. Barcos com tripula√ß√£o n√£o exigem.',
    'capacidade m√°xima': 'Cada barco tem capacidade espec√≠fica (2-20 pessoas). Veja nos detalhes do barco antes de reservar.',
    'tem churrasqueira': 'Muitos barcos t√™m churrasqueira! Use o filtro "Churrasqueira" na busca ou veja nas comodidades.',
    'tem bar a bordo': 'Barcos de luxo geralmente t√™m bar completo. Verifique nas comodidades ou pergunte ao propriet√°rio.',
    'tem piscina': 'Iates maiores podem ter piscina ou jacuzzi. Use o filtro "Piscina" para encontrar essas op√ß√µes.',
    'combust√≠vel incluso': 'Combust√≠vel b√°sico est√° incluso. Para viagens longas, pode haver taxa extra (informada antes).',

    // ================ LOCALIZA√á√ÉO E MARINAS ================
    'onde tem barcos': 'Temos barcos em: Rio de Janeiro, S√£o Paulo, Florian√≥polis, Salvador, Angra dos Reis, B√∫zios, Ilhabela e outras cidades litor√¢neas.',
    'marinas dispon√≠veis': 'Trabalhamos com Marina da Gl√≥ria (RJ), Marina Itaja√≠ (SC), Marina Bahia (BA) e outras marinas certificadas.',
    'como chegar na marina': 'Enviamos a localiza√ß√£o exata e instru√ß√µes de acesso por email ap√≥s confirma√ß√£o da reserva.',
    'tem estacionamento': 'A maioria das marinas oferece estacionamento. Informamos na confirma√ß√£o da reserva.',
    'endere√ßo da marina': 'O endere√ßo espec√≠fico √© enviado por email. Ex: Marina da Gl√≥ria - Av. Infante Dom Henrique, s/n - Rio de Janeiro.',

    // ================ AVALIA√á√ïES E REVIEWS ================
    'como avaliar barco': 'Ap√≥s o passeio, acesse "Minhas Reservas", clique na reserva conclu√≠da e em "Avaliar" para dar nota e coment√°rio.',
    'como ver avalia√ß√µes': 'Na p√°gina do barco, role para baixo at√© a se√ß√£o "Avalia√ß√µes" para ver coment√°rios de outros usu√°rios.',
    'posso alterar avalia√ß√£o': 'Sim, voc√™ pode editar sua avalia√ß√£o por at√© 7 dias ap√≥s public√°-la.',
    'n√£o aparece para avaliar': 'A op√ß√£o aparece apenas ap√≥s a data do passeio. Se n√£o apareceu, entre em contato conosco.',

    // ================ PERFIL E CONFIGURA√á√ïES ================
    'como editar perfil': 'Acesse "Perfil" > "Editar Perfil" para atualizar nome, email, telefone e outras informa√ß√µes.',
    'como adicionar foto': 'No menu "Perfil", toque na sua foto de perfil para tirar nova foto ou escolher da galeria.',
    'como ativar notifica√ß√µes': 'V√° em "Perfil" > "Configura√ß√µes" > "Notifica√ß√µes" e ative as que desejar receber.',
    'n√£o recebo notifica√ß√µes': 'Verifique se est√£o ativadas nas configura√ß√µes do app e do seu celular.',
    'como mudar localiza√ß√£o': 'Em "Perfil" > "Configura√ß√µes" > "Localiza√ß√£o" ou use o seletor de localiza√ß√£o na tela inicial.',
    'como ativar modo escuro': 'V√° em "Perfil" > "Configura√ß√µes" > "Apar√™ncia" e escolha "Modo Escuro".',

    // ================ FAVORITOS ================
    'como favoritar barco': 'Na p√°gina do barco, clique no √≠cone de cora√ß√£o para adicionar aos favoritos.',
    'onde ver favoritos': 'Clique na aba "Favoritos" no menu inferior ou acesse pelo menu principal.',
    'como remover favorito': 'Em "Favoritos", clique no cora√ß√£o preenchido para remover da lista.',

    // ================ CLIMA E SEGURAN√áA ================
    'informa√ß√µes do clima': 'Mostramos clima atual e previs√£o na tela inicial para ajudar no planejamento do passeio.',
    'passeio com chuva': 'Recomendamos reagendar em caso de tempestade. Para chuva leve, muitos barcos t√™m cobertura.',
    'equipamentos seguran√ßa': 'Todos os barcos incluem: coletes salva-vidas, kit primeiros socorros, sinalizadores e r√°dio de emerg√™ncia.',
    'seguro incluso': 'Oferecemos seguro b√°sico. Na reserva, voc√™ pode contratar seguro adicional para maior cobertura.',

    // ================ CHAT E SUPORTE ================
    'como falar propriet√°rio': 'Na p√°gina do barco, clique em "Conversar" para abrir chat direto com o propriet√°rio.',
    'chat n√£o funciona': 'Verifique sua conex√£o. Se persistir, reinicie o app ou entre em contato pelo suporte.',
    'como entrar em contato': 'Use este chat de suporte, email suporte@jetts.com ou telefone (21) 99999-9999.',
    'hor√°rio de atendimento': 'Suporte funciona 24/7. Propriet√°rios respondem conforme disponibilidade.',

    // ================ PROMO√á√ïES E OFERTAS ================
    'como ver promo√ß√µes': 'Clique em "Promo√ß√µes" na tela inicial para ver ofertas especiais, cupons e descontos.',
    'quando tem desconto': 'Oferecemos descontos sazonais, early bird (reserva antecipada) e para usu√°rios frequentes.',
    'programa fidelidade': 'A cada 5 reservas, voc√™ ganha 10% de desconto na pr√≥xima. Acompanhe em "Perfil" > "Recompensas".',
    'desconto primeira reserva': 'Novos usu√°rios ganham 15% de desconto na primeira reserva! Use o cupom BEM-VINDO.',

    // ================ PROBLEMAS T√âCNICOS ================
    'app n√£o abre': 'Tente fechar e abrir novamente. Se persistir, reinicie o celular ou reinstale o app.',
    'app est√° lento': 'Verifique sua conex√£o com internet. Feche outros apps para liberar mem√≥ria.',
    'n√£o consigo fazer pagamento': 'Verifique dados do cart√£o e limite. Para PIX, confirme se escaneou o QR Code corretamente.',
    'fotos n√£o carregam': 'Problemas de conex√£o podem afetar carregamento. Tente novamente com Wi-Fi.',
    'busca n√£o funciona': 'Verifique se permitiu acesso √† localiza√ß√£o. Tente buscar por cidade espec√≠fica.',

    // ================ POL√çTICAS E TERMOS ================
    'pol√≠tica cancelamento': 'Cancelamento gratuito at√© 24h antes. Entre 24h-12h: 50% de taxa. Menos de 12h: 100% de taxa.',
    'pol√≠tica reembolso': 'Reembolso processado em 5-7 dias √∫teis no mesmo m√©todo de pagamento original.',
    'termos de uso': 'Acesse "Perfil" > "Termos de Uso" para ler todas as condi√ß√µes de uso da plataforma.',
    'pol√≠tica privacidade': 'Seus dados s√£o protegidos conforme LGPD. Veja em "Perfil" > "Pol√≠tica de Privacidade".',
    'idade m√≠nima': 'Usu√°rios menores de 18 anos precisam de autoriza√ß√£o dos respons√°veis para usar o app.',

    // ================ MODO PROPRIET√ÅRIO ================
    'como ser propriet√°rio': 'Clique em "Seja um Propriet√°rio" no menu ou cadastre seu barco em "Perfil" > "Meus Barcos".',
    'como cadastrar barco': 'No modo propriet√°rio: clique em "Adicionar Barco", preencha informa√ß√µes, adicione fotos e defina pre√ßos.',
    'como aprovar reservas': 'No painel do propriet√°rio, v√° em "Reservas Pendentes" e clique em "Aprovar" ou "Recusar".',
    'taxa do propriet√°rio': 'Cobramos 15% de comiss√£o sobre cada reserva confirmada (j√° inclu√≠da no pre√ßo mostrado).',
    'como receber pagamentos': 'Pagamentos s√£o transferidos para sua conta banc√°ria em at√© 2 dias √∫teis ap√≥s o check-in.',

    // ================ RECURSOS ESPECIAIS ================
    'busca por voz': 'Clique no microfone e diga o que procura: "quero um iate de luxo no Rio de Janeiro para 8 pessoas".',
    'compartilhar barco': 'Na p√°gina do barco, clique em "Compartilhar" para enviar por WhatsApp, Instagram ou copiar link.',
    'lista desejos': 'Salve barcos em "Favoritos" para criar sua lista de desejos e acompanhar mudan√ßas de pre√ßo.',
    'reservas grupos': 'Para grupos grandes (+15 pessoas), entre em contato para cota√ß√£o especial e descontos.',

    // ================ COMODIDADES ESPEC√çFICAS ================
    'tem wifi': 'Muitos barcos modernos oferecem Wi-Fi. Verifique na lista de comodidades de cada embarca√ß√£o.',
    'tem som': 'A maioria tem sistema de som. Voc√™ pode conectar via Bluetooth ou levar playlist no pendrive.',
    'tem geladeira': 'Barcos maiores t√™m geladeira/frigobar. Perfeito para manter bebidas e comidas geladas.',
    'tem banheiro': 'Embarca√ß√µes acima de 20 p√©s geralmente t√™m banheiro completo. Veja nas especifica√ß√µes.',
    'tem cozinha': 'Iates e catamar√£s t√™m cozinha equipada. √ìtimo para preparar refei√ß√µes a bordo.',
    'tem deck': 'Todos t√™m √°rea de deck para relaxar. Alguns t√™m deck superior com vista panor√¢mica.',

    // ================ CASOS DE USO ESPEC√çFICOS ================
    'festa anivers√°rio': 'Temos barcos ideais para festas! Procure por "Eventos" ou barcos com deck amplo e som.',
    'lua de mel': 'Para rom√¢nticos: busque por categoria "Rom√¢ntico" ou iates com jacuzzi e jantar a bordo.',
    'pesca esportiva': 'Temos barcos espec√≠ficos para pesca com equipamentos inclusos. Use filtro "Pesca".',
    'evento corporativo': 'Para empresas, oferecemos pacotes especiais com catering e apresenta√ß√£o. Entre em contato.',
    'casamento': 'Realizamos cerim√¥nias a bordo! Entre em contato para pacotes especiais de casamento.',

    // ================ DICAS E ORIENTA√á√ïES ================
    'o que levar': 'Leve: protetor solar, √≥culos escuros, toalha, roupas confort√°veis, √°gua e lanches.',
    'melhor hor√°rio': 'Manh√£ (8h-12h) e tarde (14h-18h) s√£o ideais. P√¥r do sol (17h-19h) √© m√°gico!',
    'documentos necess√°rios': 'Leve RG ou CNH. Para estrangeiros: passaporte. Menores: autoriza√ß√£o dos pais.',
    'pode beber': 'Consumo respons√°vel √© permitido. Propriet√°rio define regras espec√≠ficas do barco.',
    'pode fumar': 'Pol√≠tica varia por barco. Muitos permitem apenas em deck aberto. Verifique com propriet√°rio.',

    // ================ EMERG√äNCIAS ================
    'emerg√™ncia no mar': 'Todos os barcos t√™m r√°dio de emerg√™ncia. Ligue 185 (Marinha) ou use o bot√£o SOS do app.',
    'acidente no barco': 'Acione o propriet√°rio imediatamente e ligue 192 (SAMU) se houver feridos.',
    'barco quebrou': 'Entre em contato com propriet√°rio pelo chat. H√° seguro para reboque e assist√™ncia.',
    'me perdi': 'Use o GPS do app ou ligue para o propriet√°rio. Todos os barcos t√™m localiza√ß√£o em tempo real.',

    // ================ FEEDBACK E SUGEST√ïES ================
    'como dar sugest√£o': 'Adoramos feedback! Use "Perfil" > "Sugerir Melhoria" ou fale conosco pelo chat.',
    'reportar problema': 'Para reportar bugs ou problemas, use "Perfil" > "Reportar Problema" com detalhes.',
    'como avaliar app': 'Avalie-nos na App Store/Google Play! Sua opini√£o ajuda a melhorar para todos.',

    // ================ RECURSOS FUTUROS ================
    'novidades app': 'Acompanhe em "Perfil" > "Novidades" ou ative notifica√ß√µes para saber das atualiza√ß√µes.',
    'quando nova cidade': 'Expandimos constantemente! Cadastre-se na lista de espera para sua cidade.',

    // ================ FALLBACK E AJUDA GERAL ================
    'n√£o entendi': 'Desculpe, n√£o entendi sua pergunta. Pode reformular ou escolher um t√≥pico: Reservas, Pagamentos, Barcos, Perfil ou Suporte.',
    'ajuda': 'Posso ajudar com: Fazer Reservas, Pagamentos, Encontrar Barcos, Configurar Perfil, D√∫vidas sobre o App. O que voc√™ precisa?',
    'como funciona app': 'O Jetts conecta voc√™ aos melhores barcos do Brasil! Busque, reserve, pague e aproveite. Tudo pelo app de forma segura e f√°cil.',
    'app confi√°vel': 'Sim! Somos certificados, com pagamento seguro, seguro inclu√≠do e suporte 24/7. Milhares de navegadores felizes!',
    'outras d√∫vidas': 'Se sua d√∫vida n√£o foi esclarecida, fale comigo! Estou aqui para ajudar com tudo sobre o Jetts. üö¢',
  };

  @override
  void initState() {
    super.initState();
    // Mensagem de sauda√ß√£o autom√°tica
    Future.delayed(const Duration(milliseconds: 300), () {
      setState(() {
        _messages.add(_ChatMessage(
            'bot',
            'Ol√°! üëã Eu sou o assistente virtual da Jetts. Posso te ajudar com d√∫vidas sobre cadastro, reservas, pagamentos, promo√ß√µes e mais! √â s√≥ perguntar. üòä',
            TimeOfDay.now().format(context)));
      });
    });
  }

  void _sendMessage() {
    String text = _controller.text.trim();
    if (text.isEmpty) return;
    setState(() {
      _messages
          .add(_ChatMessage('user', text, TimeOfDay.now().format(context)));
      _controller.clear();
    });
    Future.delayed(const Duration(milliseconds: 500), () {
      String lower = text.toLowerCase();
      String? botText;
      for (final key in chatbotKnowledgeBase.keys) {
        if (lower.contains(key)) {
          botText = chatbotKnowledgeBase[key];
          break;
        }
      }
      botText ??= chatbotKnowledgeBase['n√£o entendi'] ?? 'Desculpe, n√£o entendi sua pergunta. Pode reformular ou escolher um t√≥pico: Reservas, Pagamentos, Barcos, Perfil ou Suporte.';
      setState(() {
        _messages.add(
            _ChatMessage('bot', botText!, TimeOfDay.now().format(context)));
      });
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: const Color(0xFF6C7AE0),
      appBar: PreferredSize(
        preferredSize: const Size.fromHeight(70),
        child: _buildHeader(),
      ),
      body: Column(
        children: [
          Expanded(
            child: ListView.builder(
              padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 16),
              itemCount: _messages.length,
              itemBuilder: (context, index) {
                final msg = _messages[index];
                final isUser = msg.type == 'user';
                return Align(
                  alignment:
                      isUser ? Alignment.centerRight : Alignment.centerLeft,
                  child: Container(
                    margin: const EdgeInsets.symmetric(vertical: 6),
                    padding: const EdgeInsets.symmetric(
                        horizontal: 18, vertical: 14),
                    constraints: BoxConstraints(
                        maxWidth: MediaQuery.of(context).size.width * 0.75),
                    decoration: BoxDecoration(
                      color:
                          isUser ? AppColors.primaryBlue500 : Colors.grey[100],
                      borderRadius: BorderRadius.only(
                        topLeft: const Radius.circular(20),
                        topRight: const Radius.circular(20),
                        bottomLeft: Radius.circular(isUser ? 20 : 4),
                        bottomRight: Radius.circular(isUser ? 4 : 20),
                      ),
                    ),
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        Text(
                          msg.text,
                          style: TextStyle(
                            color: isUser ? Colors.white : Colors.black87,
                            fontSize: 16,
                          ),
                        ),
                        const SizedBox(height: 6),
                        Align(
                          alignment: Alignment.bottomRight,
                          child: Text(
                            msg.time,
                            style: TextStyle(
                              color: isUser ? Colors.white70 : Colors.grey,
                              fontSize: 12,
                            ),
                          ),
                        ),
                      ],
                    ),
                  ),
                );
              },
            ),
          ),
          _buildInputBar(),
        ],
      ),
    );
  }

  Widget _buildHeader() {
    return AppBar(
      backgroundColor: const Color(0xFF6C7AE0),
      elevation: 0,
      leading: IconButton(
        icon: const Icon(Icons.arrow_back_ios_new_rounded, color: Colors.white),
        onPressed: () => Navigator.of(context).pop(),
      ),
      title: Row(
        children: [
          CircleAvatar(
            backgroundColor: Colors.white.withOpacity(0.2),
            radius: 22,
            child:
                const Icon(Icons.support_agent, color: Colors.white, size: 28),
          ),
          const SizedBox(width: 12),
          Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Text('Suporte',
                  style: AppTypography.titleMedium.copyWith(
                      color: Colors.white, fontWeight: FontWeight.bold)),
              Row(
                children: [
                  const Icon(Icons.circle, color: Colors.green, size: 10),
                  const SizedBox(width: 4),
                  Text('Online',
                      style: TextStyle(
                          color: Colors.white.withOpacity(0.85), fontSize: 13)),
                ],
              ),
            ],
          ),
        ],
      ),
    );
  }

  Widget _buildInputBar() {
    return Container(
      color: Colors.white,
      padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 10),
      child: Row(
        children: [
          IconButton(
            icon: Icon(Icons.add, color: AppColors.primaryBlue500),
            onPressed: () {},
          ),
          Expanded(
            child: TextField(
              controller: _controller,
              decoration: const InputDecoration(
                hintText: 'Mensagem',
                border: InputBorder.none,
              ),
              onSubmitted: (_) => _sendMessage(),
            ),
          ),
          Container(
            decoration: BoxDecoration(
              color: AppColors.primaryBlue500,
              shape: BoxShape.circle,
            ),
            child: IconButton(
              icon: const Icon(Icons.arrow_upward_rounded, color: Colors.white),
              onPressed: _sendMessage,
            ),
          ),
        ],
      ),
    );
  }
}

class _ChatMessage {
  final String type; // 'user' ou 'bot'
  final String text;
  final String time;
  _ChatMessage(this.type, this.text, this.time);
}
